---
title: 计网-网络层
date: 2025-08-02 14:43:28
categories:
    - 408
    - 计网
---

[22.36]
![](https://pub-35b33650d5944267a2f7969ac8f72430.r2.dev/Snipaste_2025-08-05_20-10-58.png)
默认网关是局域网（LAN）内的主机用来与外部网络（如Internet或其他子网）通信的出口，通常是路由器在该局域网内的接口IP地址，图中既是192.168.1.62，子网掩码就是27位

[22.38] 假设主机甲和主机乙已建立一个 TCP 连接，最大段长 MSS=1KB，甲一直有数据向乙发送，当甲 的拥塞窗口为 16KB 时，计时器发生了超时，则甲的拥塞窗口再次增长到 16KB 所需要的时间 至少是( )。
A. 4 RTT
B. 5 RTT
C. 11 RTT
D. 16 RTT

计时器超时后会将`ssthresh` 设置为当前拥塞窗口 (`cwnd`) 的一半。当前 `cwnd` = 16KB，新的 `ssthresh` = 16KB / 2 = **8KB**。然后新的 `cwnd` = **1KB**，在小于`ssthresh`时“慢启动”指数增长，大于后“拥塞避免”每次加1








[23.38]
![](https://pub-35b33650d5944267a2f7969ac8f72430.r2.dev/Snipaste_2025-08-02_14-40-01.png)

发送时延 = 分组长度 / 链路带宽 = 8,000 bits / (100 × 10⁶ bits/s) = 80 × 10⁻⁶ s = **0.08 ms**
传播时延 = 时延带宽积 / 链路带宽 = 1000 bits / (100 × 10⁶ bits/s) = 10 × 10⁻⁶ s = **0.01 ms**
发送所有分组需要 发送时延 * 1000个包 = 80ms 。当最后一个比特在第80ms时离开H1后，它还需要经过 "L1的传播 -> R的存储转发 -> L2的传播" 才能最终到达H2。
* **在L1上的传播**：需要 `Tp = 0.01 ms`
* **在路由器R上的转发**：路由器R采用“存储-转发”机制，它必须接收完整个分组才能开始转发。当最后一个分组的最后一个比特到达R时，意味着R已经收到了完整的分组。此时R开始向H2转发这个分组，这个过程需要一个完整的发送时延 `Tx = 0.08 ms`。
* **在L2上的传播**：最后，分组的最后一个比特从R发出后，还需要在L2上传播，需要 `Tp = 0.01 ms`。
所以是80.10ms

[23.47] 某网络拓扑如下图所示，主机 H 登录到 FTP 服务器后，向服务器上传一个大小为 18000B 的文件 F。假设 H 为传输 F 建立数据连接时，选择的初始序号为 100，MSS = 1000B，拥塞控制 的初始阈值是 4MSS，RTT = 10ms，忽略 TCP 的传输时延；在 F 的传输过程中，H 均以 MSS 段 向服务器发送数据，且未发生差错、丢包和乱序现象。连接是
H -- 交换机 -- 路由器 -- FTP服务器
(1) FTP 的控制连接是持久的还是非持久的？FTP 的数据连接是持久的还是非持久的？H 登录 FTP 服务器时，建立的 TCP 连接是控制连接还是数据连接？
(2) H 通过数据连接发送 F 时，F 的第一个字节序号是多少？在断开数据连接的过程中，FTP 服 务器发送的第二次握手 ACK 段的确认序号是多少？
(3) H 通过数据连接发送 F 的过程中，当 H 收到确认序号为 2101 的确认时，H 的拥塞窗口调整 为多少？收到确认序号为 7101 的确认时，H 的拥塞窗口调整为多少？
(4) H 从请求建立数据连接开始，到确认 F 已被服务全部接收为止，至少需要多长时间？在这期 间应用层的平均发送速率是多少？

(2) F 的第一个字节序号是101，在断开数据连接的数据过程中，共传输了18000B 的文件，因此数据的最后一个序号是18100。 在完成数据传输后，客户端发送的seq等于已传送过的数据最后一个字节的序号加1，所以seq=18101。因为TCP规定，FIN报文即使不携带数据，也消耗一个序号。所以服务器给客户端返回的ack=18102
(3) 3MSS。5MSS。主机 H 发送数据的第一个字节序号为 101, MSS 为 1000B, 代表每次可以发送的 报文段大小为 1000B。第一个报文段的序号为 101-1100, 第二个报文段的序号为 1101-2100, 以此类推。慢开始的门限值为 4MSS，在执行慢开始算法的时候，发送每收到一个对新报 文的确认 ACK，拥塞窗口值加 1。在本题中，接收到确认号为 2101，代表也接收到了确认 号 1101, 所以接收到了两个报文段的 ACK，这时候的窗口值因为还没有超过 4MSS，所以 H 的拥塞窗口值的大小为 3MSS。7101 代表的是对第 7 个报文段的确认，发送第一个报文段 (101-1100), 接收到第一个报文的确认，拥塞窗口调整为 2MSS，发送 2、3 报文段，接收到 2、3 报文段的确认，拥塞窗口调整为 4MSS，发送 4、5、6、7 报文段，并且接收到 4、5、6、 7 报文段的确认，因为拥塞窗口值已经到达门限值 4MSS，采用拥塞避免，调整拥塞窗口值 为 5MSS。
(4) 6RTT=60ms。18000B/60ms = 2.4Mbps。第 1 个 RTT：建立 TCP 连接。第 2 个 RTT 发送报 文段 1, 第 3 个 RTT 发送报文段 2-3, 第 4 个 RTT 发送报文段 4-7, 第 5 个 RTT 发送报文 段 8-12, 第六个 RTT 发送报文段 13-18。18 个报文段刚好为 18000B, 所以传输文件 F 需 要 6 个 RTT，平均传输速率为 18000B/60ms = 2.4Mbps。
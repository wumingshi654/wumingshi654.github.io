---
title: 计网-数据链路层
date: 2025-06-25 22:41:05
categories:
    - 408
    - 计网
---

将比特流封装成帧是为了在出错时只重发出错的帧而非整段数据。

### 差错校验
- 奇偶校验，分为奇校验和偶校验，在数据后加上0或1让整段数据1的个数为奇数或偶数。不能知道哪位错了，也不能发现偶数个数据出错的情况
- 循环冗余码CRC校验，就是用数据除以多项式得到的余数与数据拼接起来
- 海明码

[23.37] 若甲向乙发送数据时采用 CRC 校验，生成多项式为 $G(x) = x^4+x+1$ (即 $G=10011$)，则乙接 收到下列比特串时，可以断定其在传输过程中未发生错误的是( )。
A. 1 0111 0000
B. 1 0111 0100
C. 1 0111 1000
D. 1 0111 1100

看选项可知原数据是10111，计算即可

### 流量控制与可靠传输
- 停止等待协议，发一个等一个的确认
- 滑动窗口：后退N帧(GBN)，发送窗口>1，接受窗口=1，若采用 $n$ 比特帧编号，则其发送窗口 $W_T$ 应满足 $1 < W_T \le 2^{n}-1$。若 $W_T$ 大于 $2^{n}-1$，则会造 成接收方无法分辨新数据帧和旧数据帧；选择重传(SR)，发送窗口>1，接受窗口>1，选择重传协议的接收窗口 $W_R$ 和发送窗口 $W_T$ 都大于 1，一次可以发送或接收多个帧。若采用 $n$ 比特对帧编号，需满足条件(1)：$W_R + W_T \le 2^n$ 且 $W_R \le W_T$

[23.35] GBN和SR，帧序号位数相同，SR的发送窗口等于接受窗口，理想情况下谁的最大信道利用率高

GBN接收窗口为1，相同位数下发送窗口更大，因此最大信道利用率高

### 介质访问控制
- 纯ALOHA，想发就发，如果没收到确认就失败
- 时隙ALOHA，把时间分为等长的时隙, 结点只会在时隙开始时发送
- CSMA，在发送数据之前，先“侦听”信道。1-坚持CSMA(持续监听直到信道空闲, 1的意思是监听到信道空闲时发送的概率为1); 非坚持CSMA(等待一个随机时间再监听); p-坚持CSMA(只用于时分信道, 在时隙开始时监听是否空闲. 监听到信道空闲时有p的概率发送数据, 忙时监听下个时隙直到空闲; 这种方法可以避免1-的冲突和非坚持的浪费)

#### CSMA/CD
带冲突检测的CSMA，以太网使用此协议，它的思想是：先听再说，边说边听。
* **工作原理**：
    1.  **载波侦听 (Carrier Sense)**：发送前，先侦听信道是否空闲。
    2.  **多路访问 (Multiple Access)**：多个设备共享同一介质。
    3.  **冲突检测 (Collision Detection)**：**在发送数据的同时，持续不断地检测信道**。通过比较发送出去的信号和在信道上监听到的信号是否一致来判断是否发生冲突。
* **冲突处理**：
    * 一旦检测到冲突，立即 **停止发送** 数据。
    * 向信道发送一个简短的 **“冲突增强信号 (Jamming Signal)”**，以确保所有其他站点都能感知到此次冲突。
    * 执行 **“截断二进制指数退避算法 (Truncated Binary Exponential Backoff)”**，即在$0 \le n \le 2^{k}-1$(k为冲突次数)中选择一个随机的n乘以时间片的时间后重新开始尝试。
* **应用**：经典的总线型或基于集线器的以太网。在现代的全双工交换式以太网中，由于每个端口独享带宽，不会发生冲突，因此CSMA/CD协议通常处于关闭状态。
[23.36] 已知 10BaseT 以太网的争用时间片为 51.2us。若网卡在发送某帧时发生了连续 4 次冲突，则基于二进制指数退避算法确定的再次尝试重发该帧前等待的最长时间是 ( )。
A. 51.2us
B. 204.8us
C. 768us
D. 819.2us

最多为 $51.2 \times (2^{4}-1)$

#### CSMA/CA
带冲突避免的CSMA，主要用于**无线局域网 (WLAN, 如Wi-Fi)**，因为无线局域网无法实现“边说边听”，难以发现范围内所有设备(“隐藏站”问题)。它的思想是：**尽量避免冲突，而不是等冲突发生后再去处理**。
* **工作原理 (核心机制)**：
    1.  **发送前侦听**：与CSMA/CD一样，先侦听信道是否空闲。
    2.  **等待帧间间隔 (IFS)**：如果信道空闲，还需要再等待一个被称为“帧间间隔”的固定时长。
    3.  **随机退避**：IFS等待结束后，再等待一个随机的“退避时间”。只有当退避计时器倒数到0时，才真正开始发送数据。这使得多个想同时发送的设备因随机时间不同而错开。
    4.  **可选的RTS/CTS机制**：为了解决“隐藏站”问题，可以启用“请求发送/清除发送 (Request to Send / Clear to Send)”机制。
        * A要给B发数据前，先向B发送一个很短的 **RTS** 帧。
        * B收到后，向所有站点广播一个 **CTS** 帧。
        * 所有听到CTS的站点（包括可能对A隐藏的C站）就知道了B即将接收数据，于是在这段时间内会保持静默，从而“避免”了冲突。
